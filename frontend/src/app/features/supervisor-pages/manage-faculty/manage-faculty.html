<div class="container">
  <aside class="sidebar">
    <div class="sidebar-header">
      <span class="material-symbols-outlined logo-icon">school</span>
      <h2 class="logo-text">UNIverse</h2>
    </div>
    <nav class="nav">
      <a class="nav-link active" routerLink="/supervisor-dashboard" routerLinkActive="active"
         [routerLinkActiveOptions]="{exact: true}">
        <span class="material-symbols-outlined">dashboard</span>
        <span>Dashboard</span>
      </a>
      <a class="nav-link" routerLink="/supervisor-dashboard/course-availability" routerLinkActive="active">
        <span class="material-symbols-outlined">event_available</span>
        <span>Course Availability</span>
      </a>
      <a class="nav-link" routerLink="/supervisor-dashboard/generate-timetable" routerLinkActive="active">
        <span class="material-symbols-outlined">calendar_month</span>
        <span>Generate Timetable</span>
      </a>
      <a class="nav-link" routerLink="/supervisor-dashboard/manage-faculty" routerLinkActive="active">
        <span class="material-symbols-outlined">groups</span>
        <span>Manage Faculty</span>
      </a>
    </nav>
    <div class="sidebar-footer">
      <a class="nav-link logout-link" href="javascript:void(0)" (click)="logout()">
        <span class="material-symbols-outlined">logout</span>
        <span>Logout</span>
      </a>
    </div>
  </aside>
  <div class="main-wrapper">
    <header class="header">
      <div class="header-actions">
        <button class="notification-btn">
          <span class="material-symbols-outlined">notifications</span>
          <span class="notification-badge"></span>
        </button>
        <div class="user-avatar"
             style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAoY4Wp7qmxX4VDSoT3Vmr2qswqkkPQKnfXBi6UrbCvHMkyQzCjFcbZlORsU-j2DvMuJNYOaqwfZcgTjF_Hg8IDEtySTCcfrtyWohPVSbGWzk_oW6GXLl0Hz6W9aDh3lqrBKeUzDWnMUPNGhawW9SNYnA9mf23sryoHadAYDjt2nOqgr2sbWDfD66OJ8Z0EzkvZS8SELiYlOJitGiAXsYPceto35Ief5jqo9WsQb0JhLm_z4eaJE5XPe2C6hgQEr3qw0BVsIWoEIHM");'>
        </div>
        <div class="user-info">
          <p class="user-name">Alex Hartman</p>
          <p class="user-role">Supervisor</p>
        </div>
      </div>
    </header>
    <main class="main-content">
      <div class="content-wrapper">
        <div class="card">
          <div class="toolbar">
            <div class="search-wrapper" style="width: 70%;">
              <span class="material-symbols-outlined search-icon">search</span>
              <input class="search-input" placeholder="Search by name, ID, or email..." type="text"
                     [(ngModel)]="searchTerm" (input)="onSearchChange()" />
            </div>
            <div class="filters" style="width: 70%;">
              <select class="filter-select" [(ngModel)]="selectedDepartment" (change)="onFilterChange()"
                      style="width: 35%;">
                <option *ngFor="let dept of departments">{{ dept }}</option>
              </select>
              <select class="filter-select" [(ngModel)]="selectedPosition" (change)="onFilterChange()"
                      style="width: 35%;">
                <option *ngFor="let pos of positions">{{ pos }}</option>
              </select>
              <button class="btn-primary" (click)="openAddModal()" style="width: 25%;">
                <span class="material-symbols-outlined">person_add</span>
                <span>Add Faculty</span>
              </button>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="data-table">
              <thead>
              <tr>
                <th>Name</th>
                <th>Employee ID</th>
                <th>Department</th>
                <th>Position</th>
                <th>Courses</th>
                <th>Status</th>
                <th class="text-center">Actions</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let faculty of filteredFaculty">
                <td>
                  <div class="faculty-cell">
                    <div class="faculty-avatar" [style.background-image]="'url(' + faculty.avatar + ')'">
                    </div>
                    <div>
                      <p class="faculty-name">{{ faculty.name }}</p>
                      <p class="faculty-email">{{ faculty.email }}</p>
                    </div>
                  </div>
                </td>
                <td>{{ faculty.employeeId }}</td>
                <td>{{ faculty.department }}</td>
                <td>{{ faculty.position }}</td>
                <td>{{ faculty.courseCount }}</td>
                <td><span [ngClass]="'badge ' + getStatusBadgeClass(faculty.status)">{{ faculty.status }}</span></td>
                <td class="text-center">
                  <div class="action-buttons">
                    <button class="icon-btn" (click)="openEditModal(faculty)" title="Edit">
                      <span class="material-symbols-outlined">edit</span>
                    </button>
                    <button class="icon-btn danger" (click)="deleteFaculty(faculty)" title="Delete">
                      <span class="material-symbols-outlined">delete</span>
                    </button>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div class="pagination">
            <span class="pagination-info">Showing 1 to {{ pagination.pageSize }} of {{ pagination.totalItems }} faculty
              members</span>
            <div class="pagination-buttons">
              <a class="page-link first" (click)="previousPage()" href="javascript:void(0)">Previous</a>
              <a class="page-link" [ngClass]="{'active': pagination.currentPage === 1}" (click)="goToPage(1)"
                 href="javascript:void(0)">1</a>
              <a class="page-link" [ngClass]="{'active': pagination.currentPage === 2}" (click)="goToPage(2)"
                 href="javascript:void(0)">2</a>
              <a class="page-link last" (click)="nextPage()" href="javascript:void(0)">Next</a>
            </div>
          </div>
        </div>
        <div class="card quick-actions-card">
          <h2 class="card-title">Quick Actions</h2>
          <div class="actions-grid">
            <a class="action-card blue" (click)="openFacultySelector('edit')" href="javascript:void(0)">
              <span class="material-symbols-outlined">edit_note</span>
              <p>Edit Faculty Details</p>
            </a>
            <a class="action-card blue" (click)="openFacultySelector('assign')" href="javascript:void(0)">
              <span class="material-symbols-outlined">assignment_ind</span>
              <p>Assign Courses</p>
            </a>
            <a class="action-card blue" (click)="openFacultySelector('performance')" href="javascript:void(0)">
              <span class="material-symbols-outlined">summarize</span>
              <p>View Performance</p>
            </a>
            <a class="action-card red" (click)="openFacultySelector('deactivate')" href="javascript:void(0)">
              <span class="material-symbols-outlined">person_off</span>
              <p>Deactivate Account</p>
            </a>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<!-- Modal -->
<div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">{{ isEditMode ? 'Edit Faculty Member' : 'Add New Faculty Member' }}</h3>
      <button class="close-btn" (click)="closeModal()">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Full Name *</label>
        <input type="text" class="form-input" [(ngModel)]="currentFaculty.fullName" placeholder="e.g. Dr. John Smith">
      </div>
      <div class="form-group">
        <label class="form-label">Email *</label>
        <input type="email" class="form-input" [(ngModel)]="currentFaculty.email"
               placeholder="e.g. john.smith@university.edu">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Employee ID</label>
          <input type="text" class="form-input" [(ngModel)]="currentFaculty.phoneNumber" placeholder="e.g. 369369">
        </div>
        <div class="form-group">
          <label class="form-label">Department</label>
          <select class="form-select" [(ngModel)]="currentFaculty.department">
            <option value="Computer Science">Computer Science</option>
            <option value="Mathematics">Mathematics</option>
            <option value="Physics">Physics</option>
            <option value="History">History</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Position</label>
          <select class="form-select" [(ngModel)]="currentFaculty.specialization">
            <option *ngFor="let pos of positionOptions" [value]="pos">{{ pos }}</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Office Location</label>
          <input type="text" class="form-input" [(ngModel)]="currentFaculty.officeLocation"
                 placeholder="Building A, Room 123">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Qualifications</label>
        <input type="text" class="form-input" [(ngModel)]="currentFaculty.qualifications"
               placeholder="e.g. PhD in Computer Science">
      </div>
      <div class="form-group" *ngIf="!isEditMode">
        <label class="form-label">Password *</label>
        <input type="password" class="form-input" [(ngModel)]="currentFaculty.password" placeholder="Enter password">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeModal()">Cancel</button>
      <button class="btn-primary" (click)="saveFaculty()">{{ isEditMode ? 'Update' : 'Create' }}</button>
    </div>
  </div>
</div>

<!-- Faculty Selection Modal -->
<div class="modal-overlay" *ngIf="isFacultySelectorOpen" (click)="closeFacultySelector()">
  <div class="modal-content" (click)="$event.stopPropagation()" style="max-width: 500px;">
    <div class="modal-header">
      <h3 class="modal-title">Select Faculty Member</h3>
      <button class="close-btn" (click)="closeFacultySelector()">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <div class="modal-body">
      <!-- Search Box -->
      <div class="search-wrapper" style="max-width: 100%; margin-bottom: 16px;">
        <span class="material-symbols-outlined search-icon">search</span>
        <input class="search-input" placeholder="Search by name, email, or ID..." type="text"
               [(ngModel)]="facultySelectorSearchTerm" />
      </div>


      <div class="faculty-list">
        <div *ngFor="let faculty of searchedFaculty" class="faculty-item" (click)="selectFaculty(faculty)"
             style="padding: 12px; border-bottom: 1px solid #e0e0e0; cursor: pointer; display: flex; align-items: center; gap: 12px;">
          <div class="faculty-avatar" [style.background-image]="'url(' + faculty.avatar + ')'"
               style="width: 40px; height: 40px; border-radius: 50%; background-size: cover;"></div>
          <div style="flex: 1;">
            <p style="margin: 0; font-weight: 600; color: #333;">{{ faculty.name }}</p>
            <p style="margin: 0; font-size: 0.875rem; color: #666;">ID: {{ faculty.employeeId }} â€¢ {{ faculty.email }}
            </p>
          </div>
          <span class="material-symbols-outlined" style="color: #666;">chevron_right</span>
        </div>
      </div>
    </div>
  </div>
</div>
